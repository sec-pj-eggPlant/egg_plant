<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
            crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
            rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/signup.css" />
    <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous"
    ></script>
</head>
<body>
<div
        class="container d-flex justify-content-center align-items-center min-vh-100"
>
    <div class="row signup-box">
        <div
                class="col-6 d-flex justify-content-center align-items-center px-5"
        >
            <h1>
                <img src="/images/logo.svg" alt="" class="w-100" />
            </h1>
        </div>
        <div class="col-6 px-5">
            <h2 class="mb-5">회원정보수정</h2>
            <form method="post" action="/my/profile" id="modifyForm">
                <div class="mb-3">
                    <label for="userName" class="form-label fw-bold">이름</label>
                    <input
                            type="text"
                            class="form-control"
                            id="userName"
                            name="userName"
                            th:value="${member.userName}"
                            readonly
                    />
                </div>
                <div class="mb-3">
                    <label for="nickName" class="form-label fw-bold">닉네임</label>
                    <input
                            type="text"
                            class="form-control"
                            id="nickName"
                            name="nickName"
                            th:value="${member.nickName}"
                            readonly
                    />
                </div>
                <div class="mb-3">
                    <label for="tel" class="form-label fw-bold">전화번호</label>
                    <input
                            type="text"
                            class="form-control"
                            id="tel"
                            name="tel"
                            th:value="${member.tel}"
                    />
                </div>
                <div class="mb-3">
                    <label for="userID" class="form-label fw-bold">아이디</label>
                    <input
                            type="text"
                            class="form-control"
                            id="userID"
                            name="userID"
                            th:value="${member.userID}"
                            readonly
                    />
                </div>
                <div class="mb-3">
                    <label for="userEmail" class="form-label fw-bold">이메일</label>
                    <input
                            type="email"
                            class="form-control"
                            id="userEmail"
                            name="userEmail"
                            th:value="${member.userEmail}"
                    />
                </div>
                <div class="mb-3">
                    <label for="currentPassword" class="form-label fw-bold">기존비밀번호</label>
                    <input
                            type="password"
                            class="form-control"
                            id="currentPassword"
                            name="currentPasssword"
                    />
                </div>
                <div class="mb-3">
                    <label for="newPassword" class="form-label fw-bold">신규비밀번호</label>
                    <input
                            type="password"
                            class="form-control"
                            id="newPassword"
                            name="password"
                    />
                </div>
                <div class="mb-3">
                    <label for="newPassword2" class="form-label fw-bold">신규비밀번호 확인</label>
                    <input
                            type="password"
                            class="form-control"
                            id="newPassword2"
                            name="passsword2"
                    />
                </div>
                <div class="mb-3">
                    <div class="row">
                        <div class="col-6">
                            <button type="button" class="w-100 btn btn-primary" id="modifyBtn">MODIFY</button>
                        </div>
                        <div class="col-6">
                            <a href="/mypage/mypage" class="w-100 btn btn-secondary">CANCEL</a>
                        </div>
                    </div>
                </div>
            </form>

            <script>
                document.getElementById("modifyBtn").addEventListener("click", async () => {
                    const form = document.getElementById("modifyForm");
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData.entries());
                    console.log(data);

                    try {
                        const response = await fetch("/my/modify", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(data)
                        });

                        const result = await response.json();
                        if (result.isModify === "true") {
                            alert("회원 정보가 수정되었습니다.");
                            window.location.href = "/my/modify";
                        } else {
                            alert("수정 실패: " + result.error);
                        }
                    } catch (err) {
                        console.error(err);
                        alert("서버 오류가 발생했습니다.");
                    }
                });
            </script>
        </div>
    </div>
</div>
<footer>
    <div class="container">
        <div class="row pt-5">
            <div class="col-7">
                <ul class="d-flex gap-3">
                    <li><a href="">이용약관</a></li>
                    <li><a href="">개인정보처리방침</a></li>
                    <li><a href="">위치기반서비스</a></li>
                    <li><a href="">이용약관</a></li>
                    <li><a href="">이메일 무단수집거부</a></li>
                    <li><a href="">법적고지</a></li>
                    <li><a href="">사업자정보</a></li>
                </ul>
            </div>
            <div class="col-5">
                <p>
                    대표이사 : 이몽룡 | 개인정보보호책임자 : 임춘향 | 사업자등록번호 :
                    8282-82-828282
                </p>
                <p>
                    통신판매업종신고 : 제 2025-서울강남구-8282 | 대표이메일 :
                    gagi@gagi.store
                </p>
                <p>
                    copyright ⓒ 2021. 가지 : 가장가까운지역창고 Co., Ltd. All rights
                    reserved.
                </p>
            </div>
        </div>
    </div>
</footer>
</body>
</html>
